<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="语冰"><meta name="copyright" content="语冰"><meta name="generator" content="Hexo 6.0.0"><meta name="theme" content="hexo-theme-yun"><title>linux GNU arm开发环境搭建 | 语冰的小站</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.2.4/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><script src="https://cdn.jsdelivr.net/npm/@unocss/runtime/mini.global.js"></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"feutis.github.io","root":"/","title":"语冰的小站","version":"1.8.10","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"fireworks":{"colors":null},"vendors":{"darken":"https://cdn.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="alternate" href="/atom.xml" title="语冰的小站" type="application/atom+xml"><meta name="description" content="一直使用所谓的集成开发环境，一键完成各种事情看起来是很方便，但是会让我们对程序是如何编译链接的毫无了解，当我们想从类似keil或者DS5这种集成开发环境脱离的时候，终于发现了自己的一无所知。记录下我脱离keil，使用vscode搭建自己的linux arm开发环境的过程吧。">
<meta property="og:type" content="article">
<meta property="og:title" content="linux GNU arm开发环境搭建">
<meta property="og:url" content="http://feutis.github.io/arm/linux-GNU-arm%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/index.html">
<meta property="og:site_name" content="语冰的小站">
<meta property="og:description" content="一直使用所谓的集成开发环境，一键完成各种事情看起来是很方便，但是会让我们对程序是如何编译链接的毫无了解，当我们想从类似keil或者DS5这种集成开发环境脱离的时候，终于发现了自己的一无所知。记录下我脱离keil，使用vscode搭建自己的linux arm开发环境的过程吧。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/fffyutt/img/raw/blog/img/202203032209680.png">
<meta property="article:published_time" content="2021-04-29T15:24:58.000Z">
<meta property="article:modified_time" content="2022-03-03T15:25:55.699Z">
<meta property="article:author" content="语冰">
<meta property="article:tag" content="arm">
<meta property="article:tag" content="GNU">
<meta property="article:tag" content="linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/fffyutt/img/raw/blog/img/202203032209680.png"><script>(function() {
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="语冰"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="语冰"><span class="site-author-status" title="Looking for dawn.">🌑</span></a><div class="site-author-name"><a href="/about/">语冰</a></div><span class="site-name">语冰的小站</span><sub class="site-subtitle">like a stone</sub><div class="site-desciption">积跬步以至千里</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">9</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">7</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">13</span></a></div><a class="site-state-item hty-icon-button" href="/null" title="文档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://jq.qq.com/?_wv=1027&amp;k=g4CvG7jI" title="QQ群" target="_blank" style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/feutis" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="1276018778@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#arm-gcc"><span class="toc-number">1.</span> <span class="toc-text"> ARM-GCC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%A0%E9%9C%80%E8%A6%81%E7%9F%A5%E9%81%93%E7%9A%84%E4%BA%8B"><span class="toc-number">1.1.</span> <span class="toc-text"> 你需要知道的事</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#arm-gcc%E5%A4%A7%E5%AE%B6%E6%97%8F"><span class="toc-number">1.2.</span> <span class="toc-text"> ARM-GCC大家族</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#arm-none-eabi-gcc%E7%9A%84%E5%AE%89%E8%A3%85"><span class="toc-number">1.3.</span> <span class="toc-text"> arm-none-eabi-gcc的安装</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#openocd%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8"><span class="toc-number">2.</span> <span class="toc-text"> openocd安装与使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#openocd%E6%98%AF%E4%B8%80%E6%AC%BE%E5%BC%80%E6%BA%90%E7%9A%84%E7%94%A8%E4%BA%8E%E7%83%A7%E5%BD%95%E7%A8%8B%E5%BA%8F%E5%88%B0%E6%9D%BF%E5%AD%90%E4%BB%A5%E5%8F%8A%E8%B0%83%E8%AF%95%E7%A8%8B%E5%BA%8F%E7%9A%84%E8%BD%AF%E4%BB%B6"><span class="toc-number">3.</span> <span class="toc-text"> openocd是一款开源的，用于烧录程序到板子以及调试程序的软件。</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gdb%E8%B0%83%E8%AF%95"><span class="toc-number">4.</span> <span class="toc-text"> GDB调试</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="http://feutis.github.io/arm/linux-GNU-arm%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="语冰"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="语冰的小站"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">linux GNU arm开发环境搭建</h1><div class="post-meta"><div class="post-time"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="创建时间：2021-04-29 23:24:58" itemprop="dateCreated datePublished" datetime="2021-04-29T23:24:58+08:00">2021-04-29</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="修改时间：2022-03-03 23:25:55" itemprop="dateModified" datetime="2022-03-03T23:25:55+08:00">2022-03-03</time></div><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/linux/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">linux</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/arm/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">arm</span></a><a class="tag-item" href="/tags/GNU/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">GNU</span></a><a class="tag-item" href="/tags/linux/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">linux</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h2 id="arm-gcc"><a class="markdownIt-Anchor" href="#arm-gcc"></a> ARM-GCC</h2>
<h3 id="你需要知道的事"><a class="markdownIt-Anchor" href="#你需要知道的事"></a> 你需要知道的事</h3>
<p>以前一直使用keil作为开发环境，也研究过启动文件之类的内容，所有的工程也都是空白的文件夹，哪怕是启动文件也是自己找来加进去的。但是当我查了很多资料，在linux下载了GNU工具链，把在keil下实验无误的工程尝试手动编译一遍看看有没有问题的时候，编译器告诉我，我使用的.s文件，包括自己写的和官方提供的，每一行都是错误。（这个问题困扰了我接近一个礼拜，好吧是我太懒了）</p>
<p>好像很少有人谈到从windows_keil到linux_gcc下的开发需要最先需要了解的一点——armcc与gcc的区别。KEIL MDK使用的是armcc进行编译，而我们在linux下开发使用的是gcc进行编译，查了点资料，主要的说法就是，针对arm芯片，armcc编译出来的代码优化做的更加好，但是armcc使用是收费的，同时armcc不开源，gcc就相反吧。</p>
<p>对于单纯的程序开发来说，二者需要了解的区别就是汇编代码的格式不太一样，但是那个不一样，不能算大问题，主要你知道这点，你就能用1分钟对二者的汇编格式进行转换（我觉得完全可以写个程序做转换，或者这功能直接整合进汇编器也不是很难），具体的区别可以看<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_35748610/article/details/112823589">这篇blog</a>，反正就是除了指令是通用的，像伪指令还有其他的一些符号的定义都需要等价转化。</p>
<h3 id="arm-gcc大家族"><a class="markdownIt-Anchor" href="#arm-gcc大家族"></a> ARM-GCC大家族</h3>
<blockquote>
<p>关于arm-gcc家族的介绍从<a target="_blank" rel="noopener" href="https://microdynamics.github.io/1.%20Breeze%20Mini%E5%9B%9B%E8%BD%B4%E9%A3%9E%E8%A1%8C%E5%99%A8/2.2%20STM32%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%28ARM-GCC%29/">该网站</a>搬运，侵删</p>
</blockquote>
<p>ARM-GCC是一套交叉编译工具链家族，其命名规则统一为：<strong>arch [-vendor] [-os] [-(gnu)eabi]</strong></p>
<p>其中：</p>
<p>​	<strong>arch</strong>代表芯片的体系架构，比如ARM，MIPS等。</p>
<p>​	<strong>vendor</strong>代表工具链的提供商。</p>
<p>​	<strong>os</strong>代表目标开发板所使用的操作系统。</p>
<p>​	<strong>eabi</strong>代表 <strong>Embedded Application Binary Interface</strong>，即嵌入式应用二进制接口。</p>
<p>主要成员：</p>
<p><strong>arm-none-eabi-gcc</strong></p>
<p>（ARM architecture，no vendor，not target an operating system，complies with the ARM EABI）</p>
<p>Arm官方用于编译 ARM 架构的裸机系统（包括 ARM Linux 的 boot、kernel，不适用编译 Linux应用），一般适合 ARM7、Cortex-M 和 Cortex-R 内核的芯片使用，所以不支持那些跟操作系统关系密切的函数，比如fork(2)，他使用的是 <strong>newlib</strong> 这个专用于嵌入式系统的C库。</p>
<p><strong>arm-none-linux-gnueabi-gcc</strong></p>
<p>(ARM architecture, no vendor, creates binaries that run on the Linux operating system, and uses the GNU EABI)</p>
<p>arm-none-linux-gnueabi-gcc是一款基于GCC，底层使用<strong>glibc</strong>库，并经过Codesourcery公司优化后所推出的编译器，其浮点运算的处理能力非常优秀，主要用于编译基于ARM架构（ARM9、ARM11以及Cortex-A9）的Linux系统（包括ARM架构的U-boot、Linux内核和Linux应用等）。</p>
<p><strong>arm-eabi-gcc</strong></p>
<p>主要用于编译运行在Android ARM架构上的应用程序。</p>
<p><strong>armcc</strong></p>
<p>ARM公司官方推出的编译工具，功能和arm-none-eabi-gcc类似，可以编译裸机程序（U-boot和Kernel），但是不能编译Linux应用程序。armcc一般是和ARM集成开发工具一起进行发布的，比如KEIL MDK、ADS、RVDS和DS-5中都将armcc作为自己默认的编译器，是付费软件。</p>
<h3 id="arm-none-eabi-gcc的安装"><a class="markdownIt-Anchor" href="#arm-none-eabi-gcc的安装"></a> arm-none-eabi-gcc的安装</h3>
<p>因为我们在linux下进行STM32F4嵌入式开发，虽然会跑ucosii操作系统，但是对于很多现代操作系统来说，它也没有区分用户态内核态，是一个简单到不能再简单的操作系统了，也不会有直接调用很多相关的库（就算有我相信老师会让我们自己实现），所以这里选择arm-none-eabi-gcc作为工具链。</p>
<p>我们首先安装build-essential，这里面包含了gcc/g++的依赖以及make，关于make，可以看我写的<a target="_blank" rel="noopener" href="https://ffyutt.github.io/2021/04/arm/makefile.html">makefile用法指南</a>。</p>
<pre class="language-shell" data-language="shell"><code class="language-shell">sudo apt-get install build-essential</code></pre>
<p>如果你使用的是ubuntu12.04/14.04/16.04/16.10 32/64-bit，那么可以采用ppa安装，不过吐槽一句，感觉这个ppa也好久没维护了，安装下来的是5.0版本的，早就更新到10.2了，其实也建议按照后面的手动安装走，ppa安装安装过程如下</p>
<pre class="language-shell" data-language="shell"><code class="language-shell">sudo add-apt-repository ppa:team-gcc-arm-embedded&#x2F;ppa
sudo apt-get udpate
sudo apt-get install gcc-arm-embedded</code></pre>
<p>如果你和我一样使用的是ubuntu20.04或者其他的什么linux发行版，还是老老实实自己去下载吧</p>
<p>建议先去<a target="_blank" rel="noopener" href="https://developer.arm.com/tools-and-software/open-source-software/developer-tools/gnu-toolchain/gnu-rm/downloads">官网</a>看看有没有最新版，有最新版了把下面的下载地址替换下就好了</p>
<pre class="language-shell" data-language="shell"><code class="language-shell">cd ~&#x2F;Download
wget https:&#x2F;&#x2F;armkeil.blob.core.windows.net&#x2F;developer&#x2F;Files&#x2F;downloads&#x2F;gnu-rm&#x2F;10-2020q4&#x2F;gcc-arm-none-eabi-10-2020-q4-major-x86_64-linux.tar.bz2
tar -xvf gcc-arm-none-eabi-10-2020-q4-major-x86_64-linux.tar.bz2
&#x2F;&#x2F;这里我建议把解压出来的文件丢到&#x2F;usr&#x2F;lib,这是我个人的习惯，你就放在download里也没关系
&#x2F;&#x2F;然后在你终端里添加环境变量
vi ~&#x2F;.bashrc
export PATH&#x3D;$PATH:&#x2F;usr&#x2F;lib&#x2F;gcc&#x2F;gcc-arm-none-eabi-10-2020-q4-major&#x2F;bin
source ~&#x2F;.bashrc</code></pre>
<p>好了应该没问题了（不得不吐槽一句，我一开始被教程骗了去安装的5.0版本的，那玩意不知道有什么问题，加了环境变量语法检查都通过了，arm-none-eabi-gcc -v就是找不到命令，去换了最新版的压缩包才成功，太坑爹了）</p>
<pre class="language-shell" data-language="shell"><code class="language-shell">arm-none-eabi-gcc -v</code></pre>
<p>打印出版本信息就好了，其实也可以去/usr/lib/gcc/gcc-arm-none-eabi-10-2020-q4-major/bin目录下看看到底这个工具链里有什么，不只gcc，包括什么nm，g++，ld一大堆东西，我们也只会使用其中的一点点。</p>
<h2 id="openocd安装与使用"><a class="markdownIt-Anchor" href="#openocd安装与使用"></a> openocd安装与使用</h2>
<h2 id="openocd是一款开源的用于烧录程序到板子以及调试程序的软件"><a class="markdownIt-Anchor" href="#openocd是一款开源的用于烧录程序到板子以及调试程序的软件"></a> openocd是一款开源的，用于烧录程序到板子以及调试程序的软件。</h2>
<p>具体使用的时候，OpenOCD需要依靠一种叫做 <strong>调试适配器</strong>（点击<a target="_blank" rel="noopener" href="http://openocd.org/doc-release/html/Debug-Adapter-Hardware.html#Debug-Adapter-Hardware">这里</a>获得OpenOCD所支持的完成设备列表）的硬件模块来帮助其在底层提供与目标板子相一致的电信号，因此只要在配置文件中对所使用的芯片和调试适配器的具体型号进行指定，OpenOCD就可以通过驱动与连接有硬件芯片的适配器进行数据通信，从而最终实现板级代码的烧写和调试。</p>
<p>我们可以使用apt安装。</p>
<pre class="language-shell" data-language="shell"><code class="language-shell">sudo apt-get install openocd</code></pre>
<p>​	安装后我们需要把usb设备接进我们的虚拟机，vm的接入方式如下</p>
<p><img src="https://gitee.com/fffyutt/img/raw/blog/img/202203032209680.png" alt="连接虚拟机" / loading="lazy"></p>
<p>使用以下命令连接，这里的interface和board要根据使用协议不同和板子不同进行替换</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">openocd -f interface/stlink_v1.cfg -f board/stm32f4x.cfg</code></pre>
<h2 id="gdb调试"><a class="markdownIt-Anchor" href="#gdb调试"></a> GDB调试</h2>
<p>因为openocd的默认端口为3333，我们在openocd连接板子后，需要打开gdb，载入我们编译出来的elf文件，随后进入gdb，使用如下已经编辑好的gdb脚本即可直接连接gdb到板子上</p>
<pre class="language-shell" data-language="shell"><code class="language-shell">define gdbinit
    <span class="token keyword">if</span> <span class="token variable">$argc</span> <span class="token operator">!=</span> <span class="token number">0</span>
        <span class="token builtin class-name">help</span> gdbinit
    <span class="token keyword">else</span>
        target remote localhost: <span class="token number">3333</span>
        monitor reset
        monitor <span class="token function">halt</span>
        load
    end
end

define mb
    b HardFault_Handler
    b PendSV_Handler

document gdbinit
    在openocd开启后将elf文件载入目标板
    usage: gdbinit port
end</code></pre>
<p>然后就可以快乐的使用gdb调试了。</p>
<p>这里有一个小技巧，我们可以先用armgcc工具反汇编出一个带各种符号的asm文件，对着这个文件进行debug会比较方便，（不得不说keil能做的确实多，这里keil就能直接帮我们映射程序运行到汇编的哪一行了）</p>
<p>注意在gdb中使用openocd的命令控制板子需要在前面加上monitor，就比如前面脚本的里的reset和halt一样。</p>
<p>​</p>
<p>​</p>
</div></section><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="打赏" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">我很可爱，请给我钱</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://gitee.com/fffyutt/img/raw/blog/img/202202280020498.jpg"><img loading="lazy" src="https://gitee.com/fffyutt/img/raw/blog/img/202202280020498.jpg" alt="支付宝" title="支付宝"></a><div><span style="color:#00A3EE"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-alipay-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://gitee.com/fffyutt/img/raw/blog/img/202202280021331.jpg"><img loading="lazy" src="https://gitee.com/fffyutt/img/raw/blog/img/202202280021331.jpg" alt="微信支付" title="微信支付"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>语冰</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="http://feutis.github.io/arm/linux-GNU-arm%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" title="linux GNU arm开发环境搭建">http://feutis.github.io/arm/linux-GNU-arm%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> 许可协议。</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/%E5%9B%9B%E8%BD%B4%E9%A3%9E%E8%A1%8C%E5%99%A8/%E5%9B%9B%E5%85%83%E6%95%B0/" rel="prev" title="四元数"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">四元数</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/arm/linker-script/" rel="next" title="linker_script"><span class="post-nav-text">linker_script</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2021 – 2022 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> 语冰</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v6.0.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.8.10</span></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a></div></body></html>